/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2022 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

$(document).ready(()=>{var s,a=$("#table_data");function t(){$.ajax({url:"http://localhost:4000/users/list",method:"GET",crossDomain:!0,xhrFields:{withCredentials:!1},success:t=>{t&&t.forEach((t,e)=>{t=`
                                        <tr id="row${e}">
                                            <th scope="row">${t.id}</th>
                                            <td class="row-role">${t.role}</td>
                                            <td>${t.email}</td>
                                            <td>${t.password}</td>
                                            <td>${t.fname}</td>
                                            <td>${t.mname}</td>
                                            <td>${t.lname}</td>
                                            <td class="actions">
                                                <button type="button" class="btn btn-warning data-edit" data-toggle="modal" data-target="#editModal">Edit</button>
                                                <button type="button" class="btn btn-danger data-delete">Delete</button>
                                            </td>
                                        </tr>
                                        `;a.append(t)})},error:t=>{console.log(t)}})}function o(){$("#table_data").empty(),t()}t(),$("#staff_table").on("click",".data-edit",t=>{var e=$(t.target.closest("tr")).children("td"),t=$(t.target.closest("tr")).find("th"),a=[];e.each((t,e)=>{"actions"!=$(e).attr("class")&&a.push(e.innerHTML)}),$("#edit-form").children("div").each((t,e)=>{e=$(e).find("input");null!=e.attr("placeholder")&&(e.attr("placeholder",a[t]),e.val(a[t]))}),s=t.html()}),$("#save-edit").on("click",()=>{var t=$("#edit-form").serializeArray();t.push({name:"id",value:s}),$.ajax({url:"http://localhost:4000/users/edit",type:"POST",data:t,crossDomain:!0,xhrFields:{withCredentials:!1},success:t=>{t&&"success"==t&&(console.log("saved"),o())},error:t=>{console.log(t)}})}),$("#staff_table").on("click",".data-delete",t=>{var e=$(t.target.closest("tr")).find("th");"admin"==$(t.target.closest("tr")).find(".row-role").html()?console.log("cannot delete: reason admin"):$.ajax({url:"http://localhost:4000/users/edit",type:"DELETE",data:{name:"id",value:e.html()},crossDomain:!0,xhrFields:{withCredentials:!1},success:t=>{t&&"success"==t&&(console.log("saved"),o())},error:t=>{console.log(t)}})}),$("#add-row").on("click",()=>{var t=$(".table_add form").serializeArray();$.ajax({url:"http://localhost:4000/users/add",type:"POST",data:t,crossDomain:!0,xhrFields:{withCredentials:!1},success:t=>{t&&"success"==t&&(console.log("saved"),o())},error:t=>{console.log(t)}})})});