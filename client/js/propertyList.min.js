/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2022 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

$(document).ready(()=>{$.ajax({url:"http://localhost:4000/user/propertylist/",method:"GET",crossDomain:!0,xhrFields:{withCredentials:!1},success:a=>{a&&a.forEach((a,e)=>{a=`
                                        <div class="card m-3" style="width: 18rem;">
                                            <img src="../img/placeholder-home.png" class="card-img-top" alt="...">
                                            <div class="card-body">
                                                <h3 class="card-title">${a.name}</h3>
                                                <h6 class="card-text">${a.address}</h6>
                                                <h4 class="card-text">P${a.monthly}</h4>
                                                <a href="#" id="p_${a.id}" class="btn btn-primary property-details">More Details</a>
                                            </div>
                                        </div>
                                        `;$("#property-list").append(a)})},error:a=>{console.log(a)}}),$("#property-list").on("click",".property-details",a=>{a=$(a.target).attr("id").split("_")[1];$.ajax({url:`http://localhost:4000/user/propertylist/${a}`,method:"GET",crossDomain:!0,xhrFields:{withCredentials:!1},success:a=>{a&&(a=`
                                        <div class="modal fade" id="viewProp" tabindex="-1" aria-labelledby="view" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h3 class="modal-title" id="property-name">${a[0].name}</h3>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <img src="../img/placeholder-home.png" class="card-img-top" alt="...">
                                                        <h5>Owned by ${a[0].owner}</h5>
                                                        <h5>${a[0].description}</h5>
                                                        <h5>At the address: <br><span id="property-address">${a[0].address}</span></h5>
                                                        <h4>Starting at P<span id="property-price">${a[0].monthly}</span> Monthly for 12 Months!</h4>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" id="p_${a[0].id}" class="btn btn-success purchase">Purchase</button>
                                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Dismiss</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        `,$("#property-modal").empty(),$("#property-modal").append(a),$("#viewProp").modal("show"))},error:a=>{console.log(a)}})}),$("#property-modal").on("click",".purchase",a=>{a=[{name:"id",value:$(a.target).attr("id").split("_")[1]},{name:"name",value:$("#property-modal #property-name").html()},{name:"address",value:$("#property-modal #property-address").html()},{name:"price",value:12*$("#property-modal #property-price").html()}];$.ajax({url:"http://localhost:4000/user/property/purchase",type:"POST",data:a,crossDomain:!0,xhrFields:{withCredentials:!1},success:a=>{a&&"success"==a&&(console.log("saved"),$("#viewProp").modal("hide"))},error:a=>{console.log(a)}})})});