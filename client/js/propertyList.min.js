/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2022 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

$(document).ready(()=>{var a=localStorage.getItem("id"),s=localStorage.getItem("username");$.ajax({url:"http://localhost:4000/user/propertylist/",method:"GET",crossDomain:!0,xhrFields:{withCredentials:!1},success:e=>{e&&e.forEach((e,a)=>{e=`
                                        <div class="card m-3" style="width: 18rem;">
                                            <img src="../img/placeholder-home.png" class="card-img-top" alt="...">
                                            <div class="card-body">
                                                <h3 class="card-title">${e.name}</h3>
                                                <h6 class="card-text">${e.address}</h6>
                                                <h4 class="card-text">P${e.monthly}</h4>
                                                <a href="#" id="p_${e.id}" class="btn btn-primary property-details">More Details</a>
                                            </div>
                                        </div>
                                        `;$("#property-list").append(e)})},error:e=>{console.log(e)}}),$("#property-list").on("click",".property-details",e=>{e=$(e.target).attr("id").split("_")[1];$.ajax({url:`http://localhost:4000/user/propertylist/${e}`,method:"GET",crossDomain:!0,xhrFields:{withCredentials:!1},success:e=>{e&&(e=`
                                        <div class="modal fade" id="viewProp" tabindex="-1" aria-labelledby="view" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered modal-lg">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h3 class="modal-title" id="property-name">${e[0].name}</h3>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <img src="../img/placeholder-home.png" class="card-img-top" alt="...">
                                                        <h5>Owned by ${e[0].owner}</h5>
                                                        <h5>${e[0].description}</h5>
                                                        <h5>At the address: <br><span id="property-address">${e[0].address}</span></h5>
                                                        <h4>Starting at P<span id="property-price">${e[0].monthly}</span> Monthly for 12 Months!</h4>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" id="p_${e[0].id}" class="btn btn-success purchase">Purchase</button>
                                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Dismiss</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        `,$("#property-modal").empty(),$("#property-modal").append(e),$("#viewProp").modal("show"))},error:e=>{console.log(e)}})}),$("#property-modal").on("click",".purchase",e=>{e=[{name:"id",value:$(e.target).attr("id").split("_")[1]},{name:"user_id",value:a},{name:"user_name",value:s},{name:"name",value:$("#property-modal #property-name").html()},{name:"address",value:$("#property-modal #property-address").html()},{name:"price",value:12*$("#property-modal #property-price").html()}];$.ajax({url:"http://localhost:4000/user/property/purchase",type:"POST",data:e,crossDomain:!0,xhrFields:{withCredentials:!1},success:e=>{e&&"success"==e&&(console.log("saved"),$("#viewProp").modal("hide"))},error:e=>{console.log(e)}})})});